<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8" />
        <meta name="generator" content="Pelican" />
        <title>Homework 2</title>
        <link rel="stylesheet" href="/theme/css/main.css" />
        <link href="/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Homework for BIOS-823-2021 Atom Feed" />
      <link rel="alternate" hreflang="en" href="/homework-2.html">

        <meta name="description" content="Creating effective visualizations using best practices Using https://github.com/cliburn/bios-823-2021/blob/main/homework/assignments.md Outline of..." />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">Homework for BIOS-823-2021</a></h1>
                <nav><ul>
                    <li><a href="/pages/about.html">About</a></li>
                    <li class="active"><a href="/category/misc.html">misc</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="/homework-2.html" rel="bookmark"
           title="Permalink to Homework 2">Homework 2</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2021-09-30T00:00:00-04:00">
                Published: Thu 30 September 2021
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/xige-huang.html">Xige Huang</a>
        </address>
<p>In <a href="/category/misc.html">misc</a>.</p>
Translations:
        <a href="/homework-2.html" hreflang="en">en</a>

</footer><!-- /.post-info -->      <h1>Creating effective visualizations using best practices</h1>
<p>Using <a href="https://github.com/cliburn/bios-823-2021/blob/main/homework/assignments.md">https://github.com/cliburn/bios-823-2021/blob/main/homework/assignments.md</a></p>
<p><strong>Outline of this post</strong>:</p>
<ul>
<li><a href="#section1">Interactive scatter plot using Plotly</a></li>
<li><a href="#section2">Interactive dot plot using Plotly</a></li>
<li><a href="#section3">Boxplot using Seaborn</a></li>
</ul>
<h2>Scatter Plot<a name="section1"></a></h2>
<p>Because the data is time series data, therefore it's always useful to take a first look at the trend throughout the years. </p>
<p>I use <code>Plotly</code> to plot two scatter lines, which allows user to select the two countries they want to compare.</p>
<p>The first reason I chose plotly is that plotly allows intreactive filtering of the data by widgets. Moreover, the 'compare data on hover' feature is especially useful to see the exact numbers of the plots by moving through the lines.</p>
<p><a href="/images/scatter.png">scatter_plot</a></p>
<p>First read the data</p>
<div class="highlight"><pre><span></span><code><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;malaria_deaths_age.txt&#39;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="s1">&#39;Unnamed: 0&#39;</span><span class="p">)</span>

<span class="c1"># aggregate all age groups into &#39;All age&#39;</span>
<span class="n">age_agg</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;entity&#39;</span><span class="p">,</span> <span class="s1">&#39;year&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="s1">&#39;sum&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">age_agg</span><span class="p">[</span><span class="s1">&#39;age_group&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;All age&#39;</span>
<span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df</span><span class="p">,</span> <span class="n">age_agg</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div>


<p>The code to define the widgets:</p>
<div class="highlight"><pre><span></span><code><span class="n">age</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Dropdown</span><span class="p">(</span>
    <span class="n">options</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">df1</span><span class="p">[</span><span class="s1">&#39;age_group&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()),</span>
    <span class="n">value</span><span class="o">=</span><span class="s1">&#39;All age&#39;</span><span class="p">,</span>
    <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Age Group:&#39;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">entity1</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Dropdown</span><span class="p">(</span>
    <span class="n">options</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">df1</span><span class="p">[</span><span class="s1">&#39;entity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()),</span>
    <span class="n">value</span><span class="o">=</span><span class="s1">&#39;Afghanistan&#39;</span><span class="p">,</span>
    <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Country1:&#39;</span><span class="p">,</span>
    <span class="n">continuous_update</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>

<span class="n">entity2</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Dropdown</span><span class="p">(</span>
    <span class="n">options</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">df1</span><span class="p">[</span><span class="s1">&#39;entity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()),</span>
    <span class="n">value</span><span class="o">=</span><span class="s1">&#39;Zimbabwe&#39;</span><span class="p">,</span>
    <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Country2:&#39;</span><span class="p">,</span>
    <span class="n">continuous_update</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>

<span class="n">container</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">HBox</span><span class="p">([</span><span class="n">entity1</span><span class="p">,</span> <span class="n">entity2</span><span class="p">])</span>
</code></pre></div>


<p>Then create the default plot:</p>
<div class="highlight"><pre><span></span><code><span class="n">trace1</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span> <span class="n">df1</span><span class="p">[(</span><span class="n">df1</span><span class="p">[</span><span class="s1">&#39;entity&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">entity1</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df1</span><span class="p">[</span><span class="s1">&#39;age_group&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">age</span><span class="o">.</span><span class="n">value</span><span class="p">)][</span><span class="s1">&#39;year&#39;</span><span class="p">],</span> 
                    <span class="n">y</span> <span class="o">=</span> <span class="n">df1</span><span class="p">[(</span><span class="n">df1</span><span class="p">[</span><span class="s1">&#39;entity&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">entity1</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df1</span><span class="p">[</span><span class="s1">&#39;age_group&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">age</span><span class="o">.</span><span class="n">value</span><span class="p">)][</span><span class="s1">&#39;deaths&#39;</span><span class="p">],</span> 
                    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Country1&#39;</span><span class="p">)</span>
<span class="n">trace2</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span> <span class="n">df1</span><span class="p">[(</span><span class="n">df1</span><span class="p">[</span><span class="s1">&#39;entity&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">entity2</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df1</span><span class="p">[</span><span class="s1">&#39;age_group&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">age</span><span class="o">.</span><span class="n">value</span><span class="p">)][</span><span class="s1">&#39;year&#39;</span><span class="p">],</span> 
                    <span class="n">y</span> <span class="o">=</span> <span class="n">df1</span><span class="p">[(</span><span class="n">df1</span><span class="p">[</span><span class="s1">&#39;entity&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">entity2</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df1</span><span class="p">[</span><span class="s1">&#39;age_group&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">age</span><span class="o">.</span><span class="n">value</span><span class="p">)][</span><span class="s1">&#39;deaths&#39;</span><span class="p">],</span> 
                    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Country2&#39;</span><span class="p">)</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">FigureWidget</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="n">trace1</span><span class="p">,</span> <span class="n">trace2</span><span class="p">],</span>
                    <span class="n">layout</span><span class="o">=</span><span class="n">go</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span>
                        <span class="n">title</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                            <span class="n">text</span><span class="o">=</span><span class="s1">&#39; Malaria deaths per 100,000 people across time&#39;</span>
                        <span class="p">),</span>
                        <span class="n">xaxis_range</span><span class="o">=</span><span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="n">df1</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]),</span> <span class="nb">max</span><span class="p">(</span><span class="n">df1</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">])],</span>
                        <span class="n">template</span><span class="o">=</span> <span class="s1">&#39;seaborn&#39;</span>
                    <span class="p">))</span>
</code></pre></div>


<p>and define the function to update the dataset used for plotting by the interactive input</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">response</span><span class="p">(</span><span class="n">change</span><span class="p">):</span>
    <span class="n">filter_list1</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="ow">and</span> <span class="n">j</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span>
                    <span class="nb">zip</span><span class="p">(</span><span class="n">df1</span><span class="p">[</span><span class="s1">&#39;entity&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">entity1</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">df1</span><span class="p">[</span><span class="s1">&#39;age_group&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">age</span><span class="o">.</span><span class="n">value</span><span class="p">)]</span>
    <span class="n">temp_df1</span> <span class="o">=</span> <span class="n">df1</span><span class="p">[</span><span class="n">filter_list1</span><span class="p">]</span>
    <span class="n">filter_list2</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="ow">and</span> <span class="n">j</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span>
                    <span class="nb">zip</span><span class="p">(</span><span class="n">df1</span><span class="p">[</span><span class="s1">&#39;entity&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">entity2</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">df1</span><span class="p">[</span><span class="s1">&#39;age_group&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">age</span><span class="o">.</span><span class="n">value</span><span class="p">)]</span>
    <span class="n">temp_df2</span> <span class="o">=</span> <span class="n">df1</span><span class="p">[</span><span class="n">filter_list2</span><span class="p">]</span>

    <span class="k">with</span> <span class="n">g</span><span class="o">.</span><span class="n">batch_update</span><span class="p">():</span>
        <span class="n">g</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">temp_df1</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span>
        <span class="n">g</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">temp_df1</span><span class="p">[</span><span class="s1">&#39;deaths&#39;</span><span class="p">]</span>
        <span class="n">g</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">temp_df2</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span>
        <span class="n">g</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">temp_df2</span><span class="p">[</span><span class="s1">&#39;deaths&#39;</span><span class="p">]</span>
        <span class="n">g</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Year&#39;</span>
        <span class="n">g</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Number of Deaths&#39;</span>


<span class="n">entity1</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="s2">&quot;value&quot;</span><span class="p">)</span>
<span class="n">age</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="s2">&quot;value&quot;</span><span class="p">)</span>
<span class="n">entity2</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="s2">&quot;value&quot;</span><span class="p">)</span>
</code></pre></div>


<p>Finally, update the plot</p>
<div class="highlight"><pre><span></span><code><span class="n">container2</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">HBox</span><span class="p">([</span><span class="n">age</span><span class="p">])</span>
<span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">([</span><span class="n">container2</span><span class="p">,</span>
              <span class="n">container</span><span class="p">,</span>
              <span class="n">g</span><span class="p">])</span>
</code></pre></div>


<h2>Dot Plot (Bubble Plot)<a name="section2"></a></h2>
<p>I use plotly again because it can plot 'animated' graph conviniently by slider by looking at the documentation <a href="https://plotly.com/python/sliders/">https://plotly.com/python/sliders/</a>. </p>
<p>The second plot I made demonstrate how gdp and deaths number evolves by time (labelled by continent).
<a href="/images/dot.png">dot_plot</a></p>
<p>The data of population is from United Nations, Department of Economic and Social Affairs. Because the exact population is only updated to the year 2010, and therefore I only use the data from <code>alaria_deaths.csv</code> up to 2010. The data of GDP is from worldbank.org.</p>
<p>Read the data of number of death of malaria and the mapping table of country code and continent.</p>
<div class="highlight"><pre><span></span><code><span class="n">deaths</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;malaria_deaths.csv&#39;</span><span class="p">)</span>
<span class="n">deaths</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;entity&#39;</span><span class="p">,</span> <span class="s1">&#39;country code&#39;</span><span class="p">,</span> <span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="s1">&#39;deaths&#39;</span><span class="p">]</span>

<span class="n">codes</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;country_code.csv&#39;</span><span class="p">)</span>
<span class="n">codes</span> <span class="o">=</span> <span class="n">codes</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">+</span><span class="p">[</span><span class="mi">5</span><span class="p">]]</span>
<span class="c1"># standarize variable names</span>
<span class="n">codes</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;continent&#39;</span><span class="p">,</span> <span class="s1">&#39;entity&#39;</span><span class="p">,</span> <span class="s1">&#39;country code&#39;</span><span class="p">,</span> <span class="s1">&#39;numeric code&#39;</span><span class="p">]</span>
</code></pre></div>


<p>Then read, standarize, and merge the population and GDP data by either country code or numeric country code.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># read population data</span>
<span class="n">pop</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;WPP2010_DB2_F01_TOTAL_POPULATION_BOTH_SEXES.XLS&#39;</span><span class="p">,</span> <span class="n">header</span> <span class="o">=</span> <span class="mi">16</span><span class="p">)</span>
<span class="n">pop</span> <span class="o">=</span> <span class="n">pop</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">)))</span>
<span class="n">pop</span> <span class="o">=</span> <span class="n">pop</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Index&#39;</span><span class="p">,</span> <span class="s1">&#39;Variant&#39;</span><span class="p">,</span> <span class="s1">&#39;Notes&#39;</span><span class="p">])</span>
<span class="n">pop</span> <span class="o">=</span> <span class="n">pop</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span> <span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">21</span><span class="p">,</span> <span class="mi">0</span><span class="p">))]</span>
<span class="n">pop</span> <span class="o">=</span> <span class="n">pop</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Major area, region, country or area&#39;</span><span class="p">:</span><span class="s1">&#39;entity&#39;</span><span class="p">})</span>
<span class="n">pop</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">pop</span><span class="p">,</span> <span class="n">id_vars</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;entity&#39;</span><span class="p">,</span> <span class="s1">&#39;Country code&#39;</span><span class="p">])</span>
<span class="n">pop</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;entity&#39;</span><span class="p">,</span> <span class="s1">&#39;numeric code&#39;</span><span class="p">,</span> <span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="s1">&#39;population&#39;</span><span class="p">]</span>
<span class="n">pop</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">pop</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">])</span>

<span class="n">pop1</span> <span class="o">=</span> <span class="n">pop</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">codes</span><span class="p">,</span> <span class="n">on</span> <span class="o">=</span> <span class="s1">&#39;numeric code&#39;</span><span class="p">,</span> <span class="n">how</span> <span class="o">=</span> <span class="s1">&#39;left&#39;</span><span class="p">)</span>
<span class="n">pop1</span> <span class="o">=</span> <span class="n">pop1</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;entity_y&#39;</span><span class="p">,</span> <span class="s1">&#39;numeric code&#39;</span><span class="p">])</span>
<span class="n">pop1</span> <span class="o">=</span> <span class="n">pop1</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;entity_x&#39;</span><span class="p">:</span><span class="s1">&#39;entity&#39;</span><span class="p">})</span>

<span class="c1"># read gdp data</span>
<span class="n">gdp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;GDP_country.csv&#39;</span><span class="p">,</span> <span class="n">header</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">gdp</span> <span class="o">=</span> <span class="n">gdp</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Indicator Name&#39;</span><span class="p">,</span> <span class="s1">&#39;Indicator Code&#39;</span><span class="p">])</span>
<span class="n">gdp</span> <span class="o">=</span> <span class="n">gdp</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">32</span><span class="p">,</span> <span class="o">-</span><span class="mi">11</span><span class="p">))]</span>
<span class="n">gdp</span> <span class="o">=</span> <span class="n">gdp</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Country Name&#39;</span><span class="p">:</span><span class="s1">&#39;entity&#39;</span><span class="p">})</span>
<span class="n">gdp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">gdp</span><span class="p">,</span> <span class="n">id_vars</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;entity&#39;</span><span class="p">,</span> <span class="s1">&#39;Country Code&#39;</span><span class="p">])</span>
<span class="n">gdp</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;entity&#39;</span><span class="p">,</span> <span class="s1">&#39;country code&#39;</span><span class="p">,</span> <span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="s1">&#39;gdp&#39;</span><span class="p">]</span>
<span class="n">gdp</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">gdp</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">])</span>

<span class="n">gdp1</span> <span class="o">=</span> <span class="n">gdp</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">codes</span><span class="p">,</span> <span class="n">on</span> <span class="o">=</span> <span class="s1">&#39;country code&#39;</span><span class="p">,</span> <span class="n">how</span> <span class="o">=</span> <span class="s1">&#39;left&#39;</span><span class="p">)</span>
<span class="n">gdp1</span> <span class="o">=</span> <span class="n">gdp1</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;numeric code&#39;</span><span class="p">])</span>
<span class="n">gdp1</span> <span class="o">=</span> <span class="n">gdp1</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;entity_y&#39;</span><span class="p">,</span> <span class="s1">&#39;numeric code&#39;</span><span class="p">])</span>
<span class="n">gdp1</span> <span class="o">=</span> <span class="n">gdp1</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;entity_x&#39;</span><span class="p">:</span><span class="s1">&#39;entity&#39;</span><span class="p">})</span>

<span class="c1"># merge data</span>

<span class="c1"># merge deaths and population</span>
<span class="n">death_pop</span> <span class="o">=</span> <span class="n">deaths</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">pop1</span><span class="p">,</span> <span class="n">on</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;country code&#39;</span><span class="p">,</span> <span class="s1">&#39;year&#39;</span><span class="p">],</span> <span class="n">how</span> <span class="o">=</span> <span class="s1">&#39;left&#39;</span><span class="p">)</span>
<span class="n">death_pop</span> <span class="o">=</span> <span class="n">death_pop</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;entity_y&#39;</span><span class="p">])</span>
<span class="n">death_pop</span> <span class="o">=</span> <span class="n">death_pop</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;entity_x&#39;</span><span class="p">:</span><span class="s1">&#39;entity&#39;</span><span class="p">})</span>
<span class="n">death_pop</span> <span class="o">=</span> <span class="n">death_pop</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;population&#39;</span><span class="p">])</span>

<span class="c1"># merge with GDP</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">death_pop</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">gdp1</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="s1">&#39;country code&#39;</span><span class="p">,</span> <span class="s1">&#39;continent&#39;</span><span class="p">],</span> <span class="n">how</span> <span class="o">=</span> <span class="s1">&#39;left&#39;</span><span class="p">)</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;entity_y&#39;</span><span class="p">])</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;entity_x&#39;</span><span class="p">:</span><span class="s1">&#39;entity&#39;</span><span class="p">})</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;country code&#39;</span><span class="p">])</span>
<span class="n">df2</span><span class="p">[</span><span class="s1">&#39;gdp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df2</span><span class="p">[</span><span class="s1">&#39;gdp&#39;</span><span class="p">]</span><span class="o">/</span><span class="mi">1000000</span>
</code></pre></div>


<p>Finally, the code to create the interactive plot with the slider is as simple as:</p>
<div class="highlight"><pre><span></span><code><span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> 
                 <span class="n">x</span><span class="o">=</span><span class="s2">&quot;gdp&quot;</span><span class="p">,</span>
                 <span class="n">y</span><span class="o">=</span><span class="s2">&quot;deaths&quot;</span><span class="p">,</span>
                 <span class="n">animation_frame</span><span class="o">=</span><span class="s2">&quot;year&quot;</span><span class="p">,</span> 
                 <span class="n">animation_group</span><span class="o">=</span><span class="s2">&quot;entity&quot;</span><span class="p">,</span>
                 <span class="n">size</span><span class="o">=</span><span class="s2">&quot;population&quot;</span><span class="p">,</span> 
                 <span class="n">color</span><span class="o">=</span><span class="s2">&quot;continent&quot;</span><span class="p">,</span>
                 <span class="n">hover_name</span><span class="o">=</span><span class="s2">&quot;entity&quot;</span><span class="p">,</span> 
                 <span class="n">size_max</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span>
                <span class="n">labels</span><span class="o">=</span><span class="p">{</span>
                     <span class="s2">&quot;gdp&quot;</span><span class="p">:</span> <span class="s2">&quot;gdp in $1,000,000&quot;</span><span class="p">,</span>
                     <span class="s2">&quot;deaths&quot;</span><span class="p">:</span> <span class="s2">&quot;deaths per 100,000 people&quot;</span>
                 <span class="p">},</span>
                <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Deaths by Malaria vs. GDP&quot;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>


<h2>Boxplot<a name="section3"></a></h2>
<p>Then I chose <code>seaborn</code>, as it produce simple and clear visulizations. For example, by the plot below we can see that the number of incidence of malaria has a clear decreasing trend over years.</p>
<p>After reading in the data on the number of incidence of malaria, I named it <code>inc</code>.</p>
<div class="highlight"><pre><span></span><code><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;Year&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;Incidence&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">inc</span><span class="p">)</span>
</code></pre></div>


<p><a href="/images/box.png">boxplot</a></p>
<p>We can zoom in by setting the limit of y-axis to take a closer look at the difference between the years</p>
<div class="highlight"><pre><span></span><code><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;figure.figsize&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">7.50</span><span class="p">,</span> <span class="mf">7.50</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;figure.autolayout&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;Year&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;Incidence&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">inc</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">700</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Incidence of Malaria(per 1,000 people) at risk by year&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>


<p><a href="/images/box_zoomed.png">boxplot_zoomed</a></p>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="https://opensource.com/article/19/5/run-your-blog-github-pages-python/">Reference</a></li>
                            <li><a href="https://github.com/cliburn/bios-823-2021/blob/main/homework/assignments.md">Homework</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>
                            <li><a href="/feeds/all.atom.xml" type="application/atom+xml" rel="alternate">atom feed</a></li>

                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="https://getpelican.com/">Pelican</a>, which takes great advantage of <a href="https://www.python.org/">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="https://www.smashingmagazine.com/2009/08/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>